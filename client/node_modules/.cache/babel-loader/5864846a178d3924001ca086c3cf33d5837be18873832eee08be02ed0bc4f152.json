{"ast":null,"code":"var _jsxFileName = \"/workspaces/chart-ni225/client/src/Chart/Chart.tsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useMemo } from \"react\";\nimport { XAxis, YAxis, Tooltip, CartesianGrid, ResponsiveContainer, ComposedChart, Bar } from \"recharts\";\nimport PeriodSelector from \"./PeriodSelector\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst getPeriodCount = period => {\n  switch (period) {\n    case \"1y\":\n      return 365;\n    case \"6m\":\n      return 183;\n    case \"3m\":\n      return 92;\n    case \"1m\":\n      return 31;\n    case \"1w\":\n      return 7;\n    default:\n      return 365;\n  }\n};\nconst Candle = props => {\n  const {\n    x,\n    y,\n    width,\n    height,\n    fill\n  } = props;\n  return /*#__PURE__*/_jsxDEV(\"rect\", {\n    x: x,\n    y: y,\n    width: width,\n    height: height,\n    fill: fill,\n    stroke: \"#333\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 36,\n    columnNumber: 10\n  }, this);\n};\n_c = Candle;\nconst Chart = ({\n  data\n}) => {\n  _s();\n  const [period, setPeriod] = useState(\"1y\");\n  const filteredData = useMemo(() => {\n    const count = getPeriodCount(period);\n    return data.slice(-count);\n  }, [data, period]);\n\n  // ローソク足用のカスタムBarデータ\n  const renderCandles = props => {\n    const {\n      x,\n      width,\n      payload\n    } = props;\n    // チャートの高さを取得\n    const chartHeight = 400 * 0.85; // ResponsiveContainer height\n    // filteredDataの値域を取得\n    const allValues = filteredData.flatMap(d => [d.open, d.close, d.high, d.low]);\n    const dataMin = Math.min(...allValues);\n    const dataMax = Math.max(...allValues);\n    // 値をチャート座標に変換（上下反転）\n    const yScale = v => (dataMax - v) / (dataMax - dataMin) * chartHeight;\n    const openY = yScale(payload.open);\n    const closeY = yScale(payload.close);\n    const highY = yScale(payload.high);\n    const lowY = yScale(payload.low);\n    const candleY = Math.min(openY, closeY);\n    const candleHeight = Math.abs(openY - closeY);\n    const color = payload.close > payload.open ? \"#e74c3c\" : \"#2ecc71\";\n    return /*#__PURE__*/_jsxDEV(\"g\", {\n      children: [/*#__PURE__*/_jsxDEV(\"line\", {\n        x1: x + width / 2,\n        x2: x + width / 2,\n        y1: highY,\n        y2: lowY,\n        stroke: color,\n        strokeWidth: 2\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 68,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"rect\", {\n        x: x,\n        y: candleY,\n        width: width,\n        height: candleHeight === 0 ? 1 : candleHeight,\n        fill: color,\n        stroke: \"#333\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 70,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 7\n    }, this);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      width: \"100%\",\n      height: 400\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"\\u65E5\\u7D4C\\u5E73\\u5747\\u682A\\u4FA1\\uFF08\\u30ED\\u30FC\\u30BD\\u30AF\\u8DB3\\u30FB\\u671F\\u9593\\u9078\\u629E\\u53EF\\uFF09\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(PeriodSelector, {\n      period: period,\n      onChange: setPeriod\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(ResponsiveContainer, {\n      width: \"100%\",\n      height: \"85%\",\n      children: /*#__PURE__*/_jsxDEV(ComposedChart, {\n        data: filteredData,\n        margin: {\n          top: 20,\n          right: 30,\n          left: 0,\n          bottom: -10\n        },\n        barCategoryGap: 2,\n        children: [/*#__PURE__*/_jsxDEV(CartesianGrid, {\n          strokeDasharray: \"3 3\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 88,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(XAxis, {\n          dataKey: \"date\",\n          minTickGap: 40\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 89,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(YAxis, {\n          domain: [dataMin => Math.floor(dataMin * 0.995), dataMax => Math.ceil(dataMax * 1.005)],\n          allowDataOverflow: false,\n          padding: {\n            top: 10,\n            bottom: 10\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 90,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Tooltip, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 95,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Bar, {\n          dataKey: \"close\",\n          shape: renderCandles,\n          minPointSize: 1,\n          maxBarSize: 10,\n          isAnimationActive: false\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 96,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 83,\n    columnNumber: 5\n  }, this);\n};\n_s(Chart, \"1IwMxhIkj+hXn6vksZLa7IVE440=\");\n_c2 = Chart;\nexport default Chart;\nvar _c, _c2;\n$RefreshReg$(_c, \"Candle\");\n$RefreshReg$(_c2, \"Chart\");","map":{"version":3,"names":["React","useState","useMemo","XAxis","YAxis","Tooltip","CartesianGrid","ResponsiveContainer","ComposedChart","Bar","PeriodSelector","jsxDEV","_jsxDEV","getPeriodCount","period","Candle","props","x","y","width","height","fill","stroke","fileName","_jsxFileName","lineNumber","columnNumber","_c","Chart","data","_s","setPeriod","filteredData","count","slice","renderCandles","payload","chartHeight","allValues","flatMap","d","open","close","high","low","dataMin","Math","min","dataMax","max","yScale","v","openY","closeY","highY","lowY","candleY","candleHeight","abs","color","children","x1","x2","y1","y2","strokeWidth","style","onChange","margin","top","right","left","bottom","barCategoryGap","strokeDasharray","dataKey","minTickGap","domain","floor","ceil","allowDataOverflow","padding","shape","minPointSize","maxBarSize","isAnimationActive","_c2","$RefreshReg$"],"sources":["/workspaces/chart-ni225/client/src/Chart/Chart.tsx"],"sourcesContent":["import React, { useState, useMemo } from \"react\";\nimport { XAxis, YAxis, Tooltip, CartesianGrid, ResponsiveContainer, ComposedChart, Bar } from \"recharts\";\nimport PeriodSelector from \"./PeriodSelector\";\n\ninterface DataPoint {\n  date: string;\n  open: number;\n  high: number;\n  low: number;\n  close: number;\n}\n\ninterface ChartProps {\n  data: DataPoint[];\n}\n\nconst getPeriodCount = (period: string) => {\n  switch (period) {\n    case \"1y\":\n      return 365;\n    case \"6m\":\n      return 183;\n    case \"3m\":\n      return 92;\n    case \"1m\":\n      return 31;\n    case \"1w\":\n      return 7;\n    default:\n      return 365;\n  }\n};\n\nconst Candle = (props: any) => {\n  const { x, y, width, height, fill } = props;\n  return <rect x={x} y={y} width={width} height={height} fill={fill} stroke=\"#333\" />;\n};\n\nconst Chart: React.FC<ChartProps> = ({ data }) => {\n  const [period, setPeriod] = useState<string>(\"1y\");\n\n  const filteredData = useMemo(() => {\n    const count = getPeriodCount(period);\n    return data.slice(-count);\n  }, [data, period]);\n\n  // ローソク足用のカスタムBarデータ\n  const renderCandles = (props: any) => {\n    const { x, width, payload } = props;\n    // チャートの高さを取得\n    const chartHeight = 400 * 0.85; // ResponsiveContainer height\n    // filteredDataの値域を取得\n    const allValues = filteredData.flatMap(d => [d.open, d.close, d.high, d.low]);\n    const dataMin = Math.min(...allValues);\n    const dataMax = Math.max(...allValues);\n    // 値をチャート座標に変換（上下反転）\n    const yScale = (v: number) => ((dataMax - v) / (dataMax - dataMin)) * chartHeight;\n    const openY = yScale(payload.open);\n    const closeY = yScale(payload.close);\n    const highY = yScale(payload.high);\n    const lowY = yScale(payload.low);\n    const candleY = Math.min(openY, closeY);\n    const candleHeight = Math.abs(openY - closeY);\n    const color = payload.close > payload.open ? \"#e74c3c\" : \"#2ecc71\";\n    return (\n      <g>\n        {/* ヒゲ */}\n        <line x1={x + width / 2} x2={x + width / 2} y1={highY} y2={lowY} stroke={color} strokeWidth={2} />\n        {/* 実体 */}\n        <rect\n          x={x}\n          y={candleY}\n          width={width}\n          height={candleHeight === 0 ? 1 : candleHeight}\n          fill={color}\n          stroke=\"#333\"\n        />\n      </g>\n    );\n  };\n\n  return (\n    <div style={{ width: \"100%\", height: 400 }}>\n      <h2>日経平均株価（ローソク足・期間選択可）</h2>\n      <PeriodSelector period={period} onChange={setPeriod} />\n      <ResponsiveContainer width=\"100%\" height=\"85%\">\n        <ComposedChart data={filteredData} margin={{ top: 20, right: 30, left: 0, bottom: -10 }} barCategoryGap={2}>\n          <CartesianGrid strokeDasharray=\"3 3\" />\n          <XAxis dataKey=\"date\" minTickGap={40} />\n          <YAxis\n            domain={[(dataMin: number) => Math.floor(dataMin * 0.995), (dataMax: number) => Math.ceil(dataMax * 1.005)]}\n            allowDataOverflow={false}\n            padding={{ top: 10, bottom: 10 }}\n          />\n          <Tooltip />\n          <Bar\n            dataKey=\"close\"\n            shape={renderCandles}\n            minPointSize={1}\n            maxBarSize={10}\n            isAnimationActive={false}\n          />\n        </ComposedChart>\n      </ResponsiveContainer>\n    </div>\n  );\n};\n\nexport default Chart;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}